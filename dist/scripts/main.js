"use strict";function debounce(e,t,a){var n;return function(){var i=this,r=arguments,o=function(){n=null,a||e.apply(i,r)},d=a&&!n;clearTimeout(n),n=setTimeout(o,t),d&&e.apply(i,r)}}var mtlMurals=function(){function e(){v=new google.maps.Map(document.getElementById("map")),window.addEventListener("resize",debounce(r,300)),t().then(function(e){return v.addListener("dragend",n),v.addListener("zoom_changed",n),v.addListener("resize",n),e}).then(a).then(i).then(function(){h.html(b),f.html(b)})}function t(){return new Promise(function(e,t){$.ajax({dataType:"json",cache:!1,url:"https://proxy.hackeryou.com",data:{reqUrl:o,xmlToJSON:!1},success:e,error:t})})}function a(e){var t=e.features;b=t.length;var a=new google.maps.LatLngBounds;t.forEach(function(e,t){var n=e.properties.latitude,i=e.properties.longitude,r=e.properties.image,o=e.properties.adresse,d=e.properties.artiste,l=e.properties.annee,s=new google.maps.Marker({position:{lat:e.properties.latitude,lng:e.properties.longitude},map:v,title:o,animation:google.maps.Animation.DROP,id:t,image:r,artist:d,year:l}),u=new google.maps.LatLng(n,i);a.extend(u),L.push(s),s.addListener("click",function(){g.html(o),p.attr("src",r),_.open()})}),v.fitBounds(a),n()}function n(){var e=v.getBounds();E=0,L.forEach(function(t){e.contains(t.position)?($("[data-index="+t.id+"]").show(),E++):$("[data-index="+t.id+"]").hide()}),h.html(E)}function i(){L.forEach(function(e){var t=document.createElement("li"),a=document.createElement("button"),n=document.createElement("p"),i=document.createElement("p"),r=document.createElement("span"),o=document.createElement("span"),p=document.createElement("div");t.classList.add(l),t.setAttribute("data-index",e.id),d[0].appendChild(t),t.appendChild(a),a.classList.add(s),i.classList.add(m),i.innerHTML=e.title,n.appendChild(i),n.classList.add(u),r.innerHTML=e.artist,o.innerHTML=" ("+e.year+")",p.setAttribute("data-bg",e.image),p.classList.add("lazyload",c),a.appendChild(p),a.appendChild(n),n.appendChild(r),n.appendChild(o)})}function r(){google.maps.event.trigger(v,"resize")}var o="http://donnees.ville.montreal.qc.ca/dataset/53d2e586-6e7f-4eae-89a1-2cfa7fc29fa0/resource/d325352b-1c06-4c3a-bf5e-1e4c98e0636b/download/murales.json",d=($(".mural-info__title"),$(".mural-info__image"),$(".mural-list")),l="mural-list__item",s="mural-list__button",u="mural-list__meta",c="mural-list__image-wrapper",m="mural-list__address",p=$(".mural-modal__image"),g=$(".mural-modal__heading"),f=$(".mural-count__total"),h=$(".mural-count__visible"),_=$("[data-remodal-id=modal]").remodal(),v={},L=[],b=0,E=void 0;return document.addEventListener("lazybeforeunveil",function(e){var t=e.target.getAttribute("data-bg");t&&(e.target.style.backgroundImage="url("+t+")")}),{initMap:e}}();mtlMurals.initMap();