"use strict";function debounce(e,t,n){var a;return function(){var i=this,o=arguments,r=function(){a=null,n||e.apply(i,o)},s=n&&!a;clearTimeout(a),a=setTimeout(r,t),s&&e.apply(i,o)}}var mtlMurals=function(){function e(){h=new google.maps.Map(document.getElementById("map")),window.addEventListener("resize",debounce(o,300)),t().then(function(e){return h.addListener("dragend",a),h.addListener("zoom_changed",a),h.addListener("resize",a),e}).then(n).then(i).then(function(){f.html(v),g.html(v)})}function t(){return new Promise(function(e,t){$.ajax({dataType:"json",cache:!1,url:"https://proxy.hackeryou.com",data:{reqUrl:r,xmlToJSON:!1},success:e,error:t})})}function n(e){var t=e.features;v=t.length;var n=new google.maps.LatLngBounds;t.forEach(function(e,t){var a=e.properties.latitude,i=e.properties.longitude,o=e.properties.image,r=e.properties.adresse,d=(e.properties.artiste,e.properties.annee,new google.maps.Marker({position:{lat:e.properties.latitude,lng:e.properties.longitude},map:h,title:r,animation:google.maps.Animation.DROP,id:t,image:o})),u=new google.maps.LatLng(a,i);n.extend(u),_.push(d),d.addListener("click",function(){s.html(r),l.attr("src",o)})}),h.fitBounds(n),a()}function a(){console.log("updating!");var e=h.getBounds();L=0,_.forEach(function(t){e.contains(t.position)?($("[data-index="+t.id+"]").show(),L++):$("[data-index="+t.id+"]").hide()}),f.html(L)}function i(){_.forEach(function(e){var t=document.createElement("li"),n=document.createElement("button"),a=document.createElement("span"),i=document.createElement("img");t.classList.add(u),t.setAttribute("data-index",e.id),d[0].appendChild(t),t.appendChild(n),n.classList.add(c),a.innerHTML=e.title,a.classList.add(m),i.setAttribute("data-src",e.image),i.classList.add("lazyload",p),n.appendChild(i),n.appendChild(a)})}function o(){google.maps.event.trigger(h,"resize")}var r="http://donnees.ville.montreal.qc.ca/dataset/53d2e586-6e7f-4eae-89a1-2cfa7fc29fa0/resource/d325352b-1c06-4c3a-bf5e-1e4c98e0636b/download/murales.json",s=$(".mural-info__title"),l=$(".mural-info__image"),d=$(".mural-list"),u="mural-list__item",c="mural-list__button",m="mural-list__span",p="mural-list__image",g=$(".mural-count__total"),f=$(".mural-count__visible"),h={},_=[],v=0,L=void 0;return{initMap:e}}();mtlMurals.initMap();